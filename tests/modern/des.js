import test from "ava";
import { DesEncryptTransform, DesDecryptTransform } from "transforms/modern/des";
import { testBytesToBytes } from "../_testutils";
import { hexToBytes, bytesToHex } from "cryptopunk.utils";

function doTest(title, expectedHex, messageHex, keyHex)
{
	const key = hexToBytes(keyHex);
	test("DES encrypts " + title, testBytesToBytes, DesEncryptTransform, expectedHex, messageHex, key);
	test("DES decrypts " + title, testBytesToBytes, DesDecryptTransform, messageHex, expectedHex, key);
}

doTest("NSB 500-20 IP and E test #01", "8000000000000000", "95f8a5e5dd31d900", "0101010101010101");
doTest("NSB 500-20 IP and E test #02", "4000000000000000", "dd7f121ca5015619", "0101010101010101");
doTest("NSB 500-20 IP and E test #03", "2000000000000000", "2e8653104f3834ea", "0101010101010101");
doTest("NSB 500-20 IP and E test #04", "1000000000000000", "4bd388ff6cd81d4f", "0101010101010101");
doTest("NSB 500-20 IP and E test #05", "0800000000000000", "20b9e767b2fb1456", "0101010101010101");
doTest("NSB 500-20 IP and E test #06", "0400000000000000", "55579380d77138ef", "0101010101010101");
doTest("NSB 500-20 IP and E test #07", "0200000000000000", "6cc5defaaf04512f", "0101010101010101");
doTest("NSB 500-20 IP and E test #08", "0100000000000000", "0d9f279ba5d87260", "0101010101010101");
doTest("NSB 500-20 IP and E test #09", "0080000000000000", "d9031b0271bd5a0a", "0101010101010101");
doTest("NSB 500-20 IP and E test #10", "0040000000000000", "424250b37c3dd951", "0101010101010101");
doTest("NSB 500-20 IP and E test #11", "0020000000000000", "b8061b7ecd9a21e5", "0101010101010101");
doTest("NSB 500-20 IP and E test #12", "0010000000000000", "f15d0f286b65bd28", "0101010101010101");
doTest("NSB 500-20 IP and E test #13", "0008000000000000", "add0cc8d6e5deba1", "0101010101010101");
doTest("NSB 500-20 IP and E test #14", "0004000000000000", "e6d5f82752ad63d1", "0101010101010101");
doTest("NSB 500-20 IP and E test #15", "0002000000000000", "ecbfe3bd3f591a5e", "0101010101010101");
doTest("NSB 500-20 IP and E test #16", "0001000000000000", "f356834379d165cd", "0101010101010101");
doTest("NSB 500-20 IP and E test #17", "0000800000000000", "2b9f982f20037fa9", "0101010101010101");
doTest("NSB 500-20 IP and E test #18", "0000400000000000", "889de068a16f0be6", "0101010101010101");
doTest("NSB 500-20 IP and E test #19", "0000200000000000", "e19e275d846a1298", "0101010101010101");
doTest("NSB 500-20 IP and E test #20", "0000100000000000", "329a8ed523d71aec", "0101010101010101");
doTest("NSB 500-20 IP and E test #21", "0000080000000000", "e7fce22557d23c97", "0101010101010101");
doTest("NSB 500-20 IP and E test #22", "0000040000000000", "12a9f5817ff2d65d", "0101010101010101");
doTest("NSB 500-20 IP and E test #23", "0000020000000000", "a484c3ad38dc9c19", "0101010101010101");
doTest("NSB 500-20 IP and E test #24", "0000010000000000", "fbe00a8a1ef8ad72", "0101010101010101");
doTest("NSB 500-20 IP and E test #25", "0000008000000000", "750d079407521363", "0101010101010101");
doTest("NSB 500-20 IP and E test #26", "0000004000000000", "64feed9c724c2faf", "0101010101010101");
doTest("NSB 500-20 IP and E test #27", "0000002000000000", "f02b263b328e2b60", "0101010101010101");
doTest("NSB 500-20 IP and E test #28", "0000001000000000", "9d64555a9a10b852", "0101010101010101");
doTest("NSB 500-20 IP and E test #29", "0000000800000000", "d106ff0bed5255d7", "0101010101010101");
doTest("NSB 500-20 IP and E test #30", "0000000400000000", "e1652c6b138c64a5", "0101010101010101"); // Fixed typo in the original document
doTest("NSB 500-20 IP and E test #31", "0000000200000000", "e428581186ec8f46", "0101010101010101");
doTest("NSB 500-20 IP and E test #32", "0000000100000000", "aeb5f5ede22d1a36", "0101010101010101");
doTest("NSB 500-20 IP and E test #33", "0000000080000000", "e943d7568aec0c5c", "0101010101010101");
doTest("NSB 500-20 IP and E test #34", "0000000040000000", "df98c8276f54b04b", "0101010101010101");
doTest("NSB 500-20 IP and E test #35", "0000000020000000", "b160e4680f6c696f", "0101010101010101");
doTest("NSB 500-20 IP and E test #36", "0000000010000000", "fa0752b07d9c4ab8", "0101010101010101");
doTest("NSB 500-20 IP and E test #37", "0000000008000000", "ca3a2b036dbc8502", "0101010101010101");
doTest("NSB 500-20 IP and E test #38", "0000000004000000", "5e0905517bb59bcf", "0101010101010101");
doTest("NSB 500-20 IP and E test #39", "0000000002000000", "814eeb3b91d90726", "0101010101010101");
doTest("NSB 500-20 IP and E test #40", "0000000001000000", "4d49db1532919c9f", "0101010101010101");
doTest("NSB 500-20 IP and E test #41", "0000000000800000", "25eb5fc3f8cf0621", "0101010101010101");
doTest("NSB 500-20 IP and E test #42", "0000000000400000", "ab6a20c0620d1c6f", "0101010101010101");
doTest("NSB 500-20 IP and E test #43", "0000000000200000", "79e90dbc98f92cca", "0101010101010101");
doTest("NSB 500-20 IP and E test #44", "0000000000100000", "866ecedd8072bb0e", "0101010101010101");
doTest("NSB 500-20 IP and E test #45", "0000000000080000", "8b54536f2f3e64a8", "0101010101010101");
doTest("NSB 500-20 IP and E test #46", "0000000000040000", "ea51d3975595b86b", "0101010101010101");
doTest("NSB 500-20 IP and E test #47", "0000000000020000", "caffc6ac4542de31", "0101010101010101");
doTest("NSB 500-20 IP and E test #48", "0000000000010000", "8dd45a2ddf90796c", "0101010101010101");
doTest("NSB 500-20 IP and E test #49", "0000000000008000", "1029d55e880ec2d0", "0101010101010101");
doTest("NSB 500-20 IP and E test #50", "0000000000004000", "5d86cb23639dbea9", "0101010101010101");
doTest("NSB 500-20 IP and E test #51", "0000000000002000", "1d1ca853ae7c0c5f", "0101010101010101");
doTest("NSB 500-20 IP and E test #52", "0000000000001000", "ce332329248f3228", "0101010101010101");
doTest("NSB 500-20 IP and E test #53", "0000000000000800", "8405d1abe24fb942", "0101010101010101");
doTest("NSB 500-20 IP and E test #54", "0000000000000400", "e643d78090ca4207", "0101010101010101");
doTest("NSB 500-20 IP and E test #55", "0000000000000200", "48221b9937748a23", "0101010101010101");
doTest("NSB 500-20 IP and E test #56", "0000000000000100", "dd7c0bbd61fafd54", "0101010101010101");
doTest("NSB 500-20 IP and E test #57", "0000000000000080", "2fbc291a570db5c4", "0101010101010101");
doTest("NSB 500-20 IP and E test #58", "0000000000000040", "e07c30d7e4e26e12", "0101010101010101");
doTest("NSB 500-20 IP and E test #59", "0000000000000020", "0953e2258e8e90a1", "0101010101010101");
doTest("NSB 500-20 IP and E test #60", "0000000000000010", "5b711bc4ceebf2ee", "0101010101010101");
doTest("NSB 500-20 IP and E test #61", "0000000000000008", "cc083f1e6d9e85f6", "0101010101010101");
doTest("NSB 500-20 IP and E test #62", "0000000000000004", "d2fd8867d50d2dfe", "0101010101010101");
doTest("NSB 500-20 IP and E test #63", "0000000000000002", "06e7ea22ce92708f", "0101010101010101");
doTest("NSB 500-20 IP and E test #64", "0000000000000001", "166b40b44aba4bd6", "0101010101010101");

doTest("NSB 500-20 PC1 and PC2 test #01", "95a8d72813daa94d", "0000000000000000", "8001010101010101");
doTest("NSB 500-20 PC1 and PC2 test #02", "0eec1487dd8c26d5", "0000000000000000", "4001010101010101");
doTest("NSB 500-20 PC1 and PC2 test #03", "7ad16ffb79c45926", "0000000000000000", "2001010101010101");
doTest("NSB 500-20 PC1 and PC2 test #04", "d3746294ca6a6cf3", "0000000000000000", "1001010101010101");
doTest("NSB 500-20 PC1 and PC2 test #05", "809f5f873c1fd761", "0000000000000000", "0801010101010101");
doTest("NSB 500-20 PC1 and PC2 test #06", "c02faffec989d1fc", "0000000000000000", "0401010101010101");
doTest("NSB 500-20 PC1 and PC2 test #07", "4615aa1d33e72f10", "0000000000000000", "0201010101010101");
doTest("NSB 500-20 PC1 and PC2 test #08", "2055123350c00858", "0000000000000000", "0180010101010101");
doTest("NSB 500-20 PC1 and PC2 test #09", "df3b99d6577397c8", "0000000000000000", "0140010101010101");
doTest("NSB 500-20 PC1 and PC2 test #10", "31fe17369b5288c9", "0000000000000000", "0120010101010101");
doTest("NSB 500-20 PC1 and PC2 test #11", "dfdd3cc64dae1642", "0000000000000000", "0110010101010101");
doTest("NSB 500-20 PC1 and PC2 test #12", "178c83ce2b399d94", "0000000000000000", "0108010101010101");
doTest("NSB 500-20 PC1 and PC2 test #13", "50f636324a9b7f80", "0000000000000000", "0104010101010101");
doTest("NSB 500-20 PC1 and PC2 test #14", "a8468ee3bc18f06d", "0000000000000000", "0102010101010101");
doTest("NSB 500-20 PC1 and PC2 test #15", "a2dc9e92fd3cde92", "0000000000000000", "0101800101010101");
doTest("NSB 500-20 PC1 and PC2 test #16", "cac09f797d031287", "0000000000000000", "0101400101010101");
doTest("NSB 500-20 PC1 and PC2 test #17", "90ba680b22aeb525", "0000000000000000", "0101200101010101");
doTest("NSB 500-20 PC1 and PC2 test #18", "ce7a24f350e280b6", "0000000000000000", "0101100101010101");
doTest("NSB 500-20 PC1 and PC2 test #19", "882bff0aa01a0b87", "0000000000000000", "0101080101010101");
doTest("NSB 500-20 PC1 and PC2 test #20", "25610288924511c2", "0000000000000000", "0101040101010101");
doTest("NSB 500-20 PC1 and PC2 test #21", "c71516c29c75d170", "0000000000000000", "0101020101010101");
doTest("NSB 500-20 PC1 and PC2 test #22", "5199c29a52c9f059", "0000000000000000", "0101018001010101");
doTest("NSB 500-20 PC1 and PC2 test #23", "c22f0a294a71f29f", "0000000000000000", "0101014001010101");
doTest("NSB 500-20 PC1 and PC2 test #24", "ee371483714c02ea", "0000000000000000", "0101012001010101");
doTest("NSB 500-20 PC1 and PC2 test #25", "a81fbd448f9e522f", "0000000000000000", "0101011001010101");
doTest("NSB 500-20 PC1 and PC2 test #26", "4f644c92e192dfed", "0000000000000000", "0101010801010101");
doTest("NSB 500-20 PC1 and PC2 test #27", "1afa9a66a6df92ae", "0000000000000000", "0101010401010101");
doTest("NSB 500-20 PC1 and PC2 test #28", "b3c1cc715cb879d8", "0000000000000000", "0101010201010101");
doTest("NSB 500-20 PC1 and PC2 test #29", "19d032e64ab0bd8b", "0000000000000000", "0101010180010101");
doTest("NSB 500-20 PC1 and PC2 test #30", "3cfaa7a7dc8720dc", "0000000000000000", "0101010140010101");
doTest("NSB 500-20 PC1 and PC2 test #31", "b7265f7f447ac6f3", "0000000000000000", "0101010120010101");
doTest("NSB 500-20 PC1 and PC2 test #32", "9db73b3c0d163f54", "0000000000000000", "0101010110010101");
doTest("NSB 500-20 PC1 and PC2 test #33", "8181b65babf4a975", "0000000000000000", "0101010108010101");
doTest("NSB 500-20 PC1 and PC2 test #34", "93c9b64042eaa240", "0000000000000000", "0101010104010101");
doTest("NSB 500-20 PC1 and PC2 test #35", "5570530829705592", "0000000000000000", "0101010102010101");
doTest("NSB 500-20 PC1 and PC2 test #36", "8638809e878787a0", "0000000000000000", "0101010101800101");
doTest("NSB 500-20 PC1 and PC2 test #37", "41b9a79af79ac208", "0000000000000000", "0101010101400101");
doTest("NSB 500-20 PC1 and PC2 test #38", "7a9be42f2009a892", "0000000000000000", "0101010101200101");
doTest("NSB 500-20 PC1 and PC2 test #39", "29038d56ba6d2745", "0000000000000000", "0101010101100101");
doTest("NSB 500-20 PC1 and PC2 test #40", "5495c6abf1e5df51", "0000000000000000", "0101010101080101");
doTest("NSB 500-20 PC1 and PC2 test #41", "ae13dbd561488933", "0000000000000000", "0101010101040101");
doTest("NSB 500-20 PC1 and PC2 test #42", "024d1ffa8904e389", "0000000000000000", "0101010101020101");
doTest("NSB 500-20 PC1 and PC2 test #43", "d1399712f99bf02e", "0000000000000000", "0101010101018001");
doTest("NSB 500-20 PC1 and PC2 test #44", "14c1d7c1cffec79e", "0000000000000000", "0101010101014001");
doTest("NSB 500-20 PC1 and PC2 test #45", "1de5279dae3bed6f", "0000000000000000", "0101010101012001");
doTest("NSB 500-20 PC1 and PC2 test #46", "e941a33f85501303", "0000000000000000", "0101010101011001");
doTest("NSB 500-20 PC1 and PC2 test #47", "da99dbbc9a03f379", "0000000000000000", "0101010101010801");
doTest("NSB 500-20 PC1 and PC2 test #48", "b7fc92f91d8e92e9", "0000000000000000", "0101010101010401");
doTest("NSB 500-20 PC1 and PC2 test #49", "ae8e5caa3ca04e85", "0000000000000000", "0101010101010201");
doTest("NSB 500-20 PC1 and PC2 test #50", "9cc62df43b6eed74", "0000000000000000", "0101010101010180");
doTest("NSB 500-20 PC1 and PC2 test #51", "d863dbb5c59a91a0", "0000000000000000", "0101010101010140");
doTest("NSB 500-20 PC1 and PC2 test #52", "a1ab2190545b91d7", "0000000000000000", "0101010101010120");
doTest("NSB 500-20 PC1 and PC2 test #53", "0875041e64c570f7", "0000000000000000", "0101010101010110");
doTest("NSB 500-20 PC1 and PC2 test #54", "5a594528bebef1cc", "0000000000000000", "0101010101010108");
doTest("NSB 500-20 PC1 and PC2 test #55", "fcdb3291de21f0c0", "0000000000000000", "0101010101010104");
doTest("NSB 500-20 PC1 and PC2 test #56", "869efd7f9f265a09", "0000000000000000", "0101010101010102");

doTest("NSB 500-20 P test #01", "88d55e54f54c97b4", "0000000000000000", "1046913489980131");
doTest("NSB 500-20 P test #02", "0c0cc00c83ea48fd", "0000000000000000", "1007103489988020");
doTest("NSB 500-20 P test #03", "83bc8ef3a6570183", "0000000000000000", "10071034c8980120");
doTest("NSB 500-20 P test #04", "df725dcad94ea2e9", "0000000000000000", "1046103489988020");
doTest("NSB 500-20 P test #05", "e652b53b550be8b0", "0000000000000000", "1086911519190101");
doTest("NSB 500-20 P test #06", "af527120c485cbb0", "0000000000000000", "1086911519580101");
doTest("NSB 500-20 P test #07", "0f04ce393db926d5", "0000000000000000", "5107b01519580101");
doTest("NSB 500-20 P test #08", "c9f00ffc74079067", "0000000000000000", "1007b01519190101");
doTest("NSB 500-20 P test #09", "7cfd82a593252b4e", "0000000000000000", "3107915498080101");
doTest("NSB 500-20 P test #10", "cb49a2f9e91363e3", "0000000000000000", "3107919498080101");
doTest("NSB 500-20 P test #11", "00b588be70d23f56", "0000000000000000", "10079115b9080140");
doTest("NSB 500-20 P test #12", "406a9a6ab43399ae", "0000000000000000", "3107911598080140");
doTest("NSB 500-20 P test #13", "6cb773611dca9ada", "0000000000000000", "1007d01589980101");
doTest("NSB 500-20 P test #14", "67fd21c17dbb5d70", "0000000000000000", "9107911589980101");
doTest("NSB 500-20 P test #15", "9592cb4110430787", "0000000000000000", "9107d01589190101");
doTest("NSB 500-20 P test #16", "a6b7ff68a318ddd3", "0000000000000000", "1007d01598980120");
doTest("NSB 500-20 P test #17", "4d102196c914ca16", "0000000000000000", "1007940498190101");
doTest("NSB 500-20 P test #18", "2dfa9f4573594965", "0000000000000000", "0107910491190401");
doTest("NSB 500-20 P test #19", "b46604816c0e0774", "0000000000000000", "0107910491190101");
doTest("NSB 500-20 P test #20", "6e7e6221a4f34e87", "0000000000000000", "0107940491190401");
doTest("NSB 500-20 P test #21", "aa85e74643233199", "0000000000000000", "19079210981a0101");
doTest("NSB 500-20 P test #22", "2e5a19db4d1962d6", "0000000000000000", "1007911998190801");
doTest("NSB 500-20 P test #23", "23a866a809d30894", "0000000000000000", "10079119981a0801");
doTest("NSB 500-20 P test #24", "d812d961f017d320", "0000000000000000", "1007921098190101");
doTest("NSB 500-20 P test #25", "055605816e58608f", "0000000000000000", "100791159819010b");
doTest("NSB 500-20 P test #26", "abd88e8b1b7716f1", "0000000000000000", "1004801598190101");
doTest("NSB 500-20 P test #27", "537ac95be69da1e1", "0000000000000000", "1004801598190102");
doTest("NSB 500-20 P test #28", "aed0f6ae3c25cdd8", "0000000000000000", "1004801598190108");
doTest("NSB 500-20 P test #29", "b3e35a5ee53e7b8d", "0000000000000000", "1002911598100104");
doTest("NSB 500-20 P test #30", "61c79c71921a2ef8", "0000000000000000", "1002911598190104");
doTest("NSB 500-20 P test #31", "e2f5728f0995013c", "0000000000000000", "1002911598100201");
doTest("NSB 500-20 P test #32", "1aeac39a61f0a464", "0000000000000000", "1002911698100101");

doTest("NSB 500-20 Key data pairs which exercise every S-box entry #01", "690f5b0d9a26939b", "01a1d6d039776742", "7ca110454a1a6e57");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #02", "7a389d10354bd271", "5cd54ca83def57da", "0131d9619dc1376e");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #03", "868ebb51cab4599a", "0248d43806f67172", "07a1133e4a0b2686");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #04", "7178876e01f19b2a", "51454b582ddf440a", "3849674c2602319e");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #05", "af37fb421f8c4095", "42fd443059577fa2", "04b915ba43feb5b6");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #06", "86a560f10ec6d85b", "059b5e0851cf143a", "0113b970fd34f2ce");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #07", "0cd3da020021dc09", "0756d8e0774761d2", "0170f175468fb5e6");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #08", "ea676b2cb7db2b7a", "762514b829bf486a", "43297fad38e373fe");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #09", "dfd64a815caf1a0f", "3bdd119049372802", "07a7137045da2a16");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #10", "5c513c9c4886c088", "26955f6835af609a", "04689104c2fd3b2f");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #11", "0a2aeeae3ff4ab77", "164d5e404f275232", "37d06bb516cb7546");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #12", "ef1bf03e5dfa575a", "6b056e18759f5cca", "1f08260d1ac2465e");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #13", "88bf0db6d70dee56", "004bd6ef09176062", "584023641aba6176");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #14", "a1f9915541020b56", "480d39006ee762f2", "025816164629b007");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #15", "6fbf1cafcffd0556", "437540c8698f3cfa", "49793ebc79b3258f");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #16", "2f22e49bab7ca1ac", "072d43a077075292", "4fb05e1515ab73a7");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #17", "5a6b612cc26cce4a", "02fe55778117f12a", "49e95d6d4ca229bf");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #18", "5f4c038ed12b2e41", "1d9d5c5018f728c2", "018310dc409b26d6");
doTest("NSB 500-20 Key data pairs which exercise every S-box entry #19", "63fac0d034d9f793", "305532286d6f295a", "1c587f1c13924fef");
