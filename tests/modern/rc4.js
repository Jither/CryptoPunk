import test from "ava";
import { Rc4Transform } from "transforms/modern/rc4";
import { testBytesToBytes } from "../_testutils";
import { hexToBytes } from "cryptopunk.utils";

function doTest(title, expectedHex, messageHex, keyHex, discard)
{
	const key = hexToBytes(keyHex);
	const options = { discardKeyBytes: discard };

	title = `${title} key '${keyHex}' (${key.length * 8} bits) offset ${discard}`;

	test("RC4 encrypts " + title, testBytesToBytes, Rc4Transform, expectedHex, messageHex, key, options);
	test("RC4 decrypts " + title, testBytesToBytes, Rc4Transform, messageHex, expectedHex, key, options);
}

doTest("RFC 6229", "b2396305f03dc027ccc3524a0a1118a8", "00000000000000000000000000000000", "0102030405",    0); 
doTest("RFC 6229", "6982944f18fc82d589c403a47a0d0919", "00000000000000000000000000000000", "0102030405",   16); 
doTest("RFC 6229", "28cb1132c96ce286421dcaadb8b69eae", "00000000000000000000000000000000", "0102030405",  240); 
doTest("RFC 6229", "1cfcf62b03eddb641d77dfcf7f8d8c93", "00000000000000000000000000000000", "0102030405",  256); 
doTest("RFC 6229", "42b7d0cdd918a8a33dd51781c81f4041", "00000000000000000000000000000000", "0102030405",  496); 
doTest("RFC 6229", "6459844432a7da923cfb3eb4980661f6", "00000000000000000000000000000000", "0102030405",  512); 
doTest("RFC 6229", "ec10327bde2beefd18f9277680457e22", "00000000000000000000000000000000", "0102030405",  752); 
doTest("RFC 6229", "eb62638d4f0ba1fe9fca20e05bf8ff2b", "00000000000000000000000000000000", "0102030405",  768); 
doTest("RFC 6229", "45129048e6a0ed0b56b490338f078da5", "00000000000000000000000000000000", "0102030405", 1008); 
doTest("RFC 6229", "30abbcc7c20b01609f23ee2d5f6bb7df", "00000000000000000000000000000000", "0102030405", 1024); 
doTest("RFC 6229", "3294f744d8f9790507e70f62e5bbceea", "00000000000000000000000000000000", "0102030405", 1520); 
doTest("RFC 6229", "d8729db41882259bee4f825325f5a130", "00000000000000000000000000000000", "0102030405", 1536); 
doTest("RFC 6229", "1eb14a0c13b3bf47fa2a0ba93ad45b8b", "00000000000000000000000000000000", "0102030405", 2032); 
doTest("RFC 6229", "cc582f8ba9f265e2b1be9112e975d2d7", "00000000000000000000000000000000", "0102030405", 2048); 
doTest("RFC 6229", "f2e30f9bd102ecbf75aaade9bc35c43c", "00000000000000000000000000000000", "0102030405", 3056); 
doTest("RFC 6229", "ec0e11c479dc329dc8da7968fe965681", "00000000000000000000000000000000", "0102030405", 3072); 
doTest("RFC 6229", "068326a2118416d21f9d04b2cd1ca050", "00000000000000000000000000000000", "0102030405", 4080); 
doTest("RFC 6229", "ff25b58995996707e51fbdf08b34d875", "00000000000000000000000000000000", "0102030405", 4096);

doTest("RFC 6229", "293f02d47f37c9b633f2af5285feb46b", "00000000000000000000000000000000", "01020304050607",    0); 
doTest("RFC 6229", "e620f1390d19bd84e2e0fd752031afc1", "00000000000000000000000000000000", "01020304050607",   16); 
doTest("RFC 6229", "914f02531c9218810df60f67e338154c", "00000000000000000000000000000000", "01020304050607",  240); 
doTest("RFC 6229", "d0fdb583073ce85ab83917740ec011d5", "00000000000000000000000000000000", "01020304050607",  256); 
doTest("RFC 6229", "75f81411e871cffa70b90c74c592e454", "00000000000000000000000000000000", "01020304050607",  496); 
doTest("RFC 6229", "0bb87202938dad609e87a5a1b079e5e4", "00000000000000000000000000000000", "01020304050607",  512); 
doTest("RFC 6229", "c2911246b612e7e7b903dfeda1dad866", "00000000000000000000000000000000", "01020304050607",  752); 
doTest("RFC 6229", "32828f91502b6291368de8081de36fc2", "00000000000000000000000000000000", "01020304050607",  768); 
doTest("RFC 6229", "f3b9a7e3b297bf9ad804512f9063eff1", "00000000000000000000000000000000", "01020304050607", 1008); 
doTest("RFC 6229", "8ecb67a9ba1f55a5a067e2b026a3676f", "00000000000000000000000000000000", "01020304050607", 1024); 
doTest("RFC 6229", "d2aa902bd42d0d7cfd340cd45810529f", "00000000000000000000000000000000", "01020304050607", 1520); 
doTest("RFC 6229", "78b272c96e42eab4c60bd914e39d06e3", "00000000000000000000000000000000", "01020304050607", 1536); 
doTest("RFC 6229", "f4332fd31a079396ee3cee3f2a4ff049", "00000000000000000000000000000000", "01020304050607", 2032); 
doTest("RFC 6229", "05459781d41fda7f30c1be7e1246c623", "00000000000000000000000000000000", "01020304050607", 2048); 
doTest("RFC 6229", "adfd3868b8e51485d5e610017e3dd609", "00000000000000000000000000000000", "01020304050607", 3056); 
doTest("RFC 6229", "ad26581c0c5be45f4cea01db2f3805d5", "00000000000000000000000000000000", "01020304050607", 3072); 
doTest("RFC 6229", "f3172ceffc3b3d997c85ccd5af1a950c", "00000000000000000000000000000000", "01020304050607", 4080); 
doTest("RFC 6229", "e74b0b9731227fd37c0ec08a47ddd8b8", "00000000000000000000000000000000", "01020304050607", 4096); 

doTest("RFC 6229", "97ab8a1bf0afb96132f2f67258da15a8", "00000000000000000000000000000000", "0102030405060708",    0); 
doTest("RFC 6229", "8263efdb45c4a18684ef87e6b19e5b09", "00000000000000000000000000000000", "0102030405060708",   16); 
doTest("RFC 6229", "9636ebc9841926f4f7d1f362bddf6e18", "00000000000000000000000000000000", "0102030405060708",  240); 
doTest("RFC 6229", "d0a990ff2c05fef5b90373c9ff4b870a", "00000000000000000000000000000000", "0102030405060708",  256); 
doTest("RFC 6229", "73239f1db7f41d80b643c0c52518ec63", "00000000000000000000000000000000", "0102030405060708",  496); 
doTest("RFC 6229", "163b319923a6bdb4527c626126703c0f", "00000000000000000000000000000000", "0102030405060708",  512); 
doTest("RFC 6229", "49d6c8af0f97144a87df21d91472f966", "00000000000000000000000000000000", "0102030405060708",  752); 
doTest("RFC 6229", "44173a103b6616c5d5ad1cee40c863d0", "00000000000000000000000000000000", "0102030405060708",  768); 
doTest("RFC 6229", "273c9c4b27f322e4e716ef53a47de7a4", "00000000000000000000000000000000", "0102030405060708", 1008); 
doTest("RFC 6229", "c6d0e7b226259fa9023490b26167ad1d", "00000000000000000000000000000000", "0102030405060708", 1024); 
doTest("RFC 6229", "1fe8986713f07c3d9ae1c163ff8cf9d3", "00000000000000000000000000000000", "0102030405060708", 1520); 
doTest("RFC 6229", "8369e1a965610be887fbd0c79162aafb", "00000000000000000000000000000000", "0102030405060708", 1536); 
doTest("RFC 6229", "0a0127abb44484b9fbef5abcae1b579f", "00000000000000000000000000000000", "0102030405060708", 2032); 
doTest("RFC 6229", "c2cdadc6402e8ee866e1f37bdb47e42c", "00000000000000000000000000000000", "0102030405060708", 2048); 
doTest("RFC 6229", "26b51ea37df8e1d6f76fc3b66a7429b3", "00000000000000000000000000000000", "0102030405060708", 3056); 
doTest("RFC 6229", "bc7683205d4f443dc1f29dda3315c87b", "00000000000000000000000000000000", "0102030405060708", 3072); 
doTest("RFC 6229", "d5fa5a3469d29aaaf83d23589db8c85b", "00000000000000000000000000000000", "0102030405060708", 4080); 
doTest("RFC 6229", "3fb46e2c8f0f068edce8cdcd7dfc5862", "00000000000000000000000000000000", "0102030405060708", 4096); 

doTest("RFC 6229", "ede3b04643e586cc907dc21851709902", "00000000000000000000000000000000", "0102030405060708090a",    0); 
doTest("RFC 6229", "03516ba78f413beb223aa5d4d2df6711", "00000000000000000000000000000000", "0102030405060708090a",   16); 
doTest("RFC 6229", "3cfd6cb58ee0fdde640176ad0000044d", "00000000000000000000000000000000", "0102030405060708090a",  240); 
doTest("RFC 6229", "48532b21fb6079c9114c0ffd9c04a1ad", "00000000000000000000000000000000", "0102030405060708090a",  256); 
doTest("RFC 6229", "3e8cea98017109979084b1ef92f99d86", "00000000000000000000000000000000", "0102030405060708090a",  496); 
doTest("RFC 6229", "e20fb49bdb337ee48b8d8dc0f4afeffe", "00000000000000000000000000000000", "0102030405060708090a",  512); 
doTest("RFC 6229", "5c2521eacd7966f15e056544bea0d315", "00000000000000000000000000000000", "0102030405060708090a",  752); 
doTest("RFC 6229", "e067a7031931a246a6c3875d2f678acb", "00000000000000000000000000000000", "0102030405060708090a",  768); 
doTest("RFC 6229", "a64f70af88ae56b6f87581c0e23e6b08", "00000000000000000000000000000000", "0102030405060708090a", 1008); 
doTest("RFC 6229", "f449031de312814ec6f319291f4a0516", "00000000000000000000000000000000", "0102030405060708090a", 1024); 
doTest("RFC 6229", "bdae85924b3cb1d0a2e33a30c6d79599", "00000000000000000000000000000000", "0102030405060708090a", 1520); 
doTest("RFC 6229", "8a0feddbac865a09bcd127fb562ed60a", "00000000000000000000000000000000", "0102030405060708090a", 1536); 
doTest("RFC 6229", "b55a0a5b51a12a8be34899c3e047511a", "00000000000000000000000000000000", "0102030405060708090a", 2032); 
doTest("RFC 6229", "d9a09cea3ce75fe39698070317a71339", "00000000000000000000000000000000", "0102030405060708090a", 2048); 
doTest("RFC 6229", "552225ed1177f44584ac8cfa6c4eb5fc", "00000000000000000000000000000000", "0102030405060708090a", 3056); 
doTest("RFC 6229", "7e82cbabfc95381b080998442129c2f8", "00000000000000000000000000000000", "0102030405060708090a", 3072); 
doTest("RFC 6229", "1f135ed14ce60a91369d2322bef25e3c", "00000000000000000000000000000000", "0102030405060708090a", 4080); 
doTest("RFC 6229", "08b6be45124a43e2eb77953f84dc8553", "00000000000000000000000000000000", "0102030405060708090a", 4096); 

doTest("RFC 6229", "9ac7cc9a609d1ef7b2932899cde41b97", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",    0); 
doTest("RFC 6229", "5248c4959014126a6e8a84f11d1a9e1c", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",   16); 
doTest("RFC 6229", "065902e4b620f6cc36c8589f66432f2b", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",  240); 
doTest("RFC 6229", "d39d566bc6bce3010768151549f3873f", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",  256); 
doTest("RFC 6229", "b6d1e6c4a5e4771cad79538df295fb11", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",  496); 
doTest("RFC 6229", "c68c1d5c559a974123df1dbc52a43b89", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",  512); 
doTest("RFC 6229", "c5ecf88de897fd57fed301701b82a259", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",  752); 
doTest("RFC 6229", "eccbe13de1fcc91c11a0b26c0bc8fa4d", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10",  768); 
doTest("RFC 6229", "e7a72574f8782ae26aabcf9ebcd66065", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 1008); 
doTest("RFC 6229", "bdf0324e6083dcc6d3cedd3ca8c53c16", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 1024); 
doTest("RFC 6229", "b40110c4190b5622a96116b0017ed297", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 1520); 
doTest("RFC 6229", "ffa0b514647ec04f6306b892ae661181", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 1536); 
doTest("RFC 6229", "d03d1bc03cd33d70dff9fa5d71963ebd", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 2032); 
doTest("RFC 6229", "8a44126411eaa78bd51e8d87a8879bf5", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 2048); 
doTest("RFC 6229", "fabeb76028ade2d0e48722e46c4615a3", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 3056); 
doTest("RFC 6229", "c05d88abd50357f935a63c59ee537623", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 3072); 
doTest("RFC 6229", "ff38265c1642c1abe8d3c2fe5e572bf8", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 4080); 
doTest("RFC 6229", "a36a4c301ae8ac13610ccbc12256cacc", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f10", 4096); 

doTest("RFC 6229", "0595e57fe5f0bb3c706edac8a4b2db11", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",    0); 
doTest("RFC 6229", "dfde31344a1af769c74f070aee9e2326", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",   16); 
doTest("RFC 6229", "b06b9b1e195d13d8f4a7995c4553ac05", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",  240); 
doTest("RFC 6229", "6bd2378ec341c9a42f37ba79f88a32ff", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",  256); 
doTest("RFC 6229", "e70bce1df7645adb5d2c4130215c3522", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",  496); 
doTest("RFC 6229", "9a5730c7fcb4c9af51ffda89c7f1ad22", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",  512); 
doTest("RFC 6229", "0485055fd4f6f0d963ef5ab9a5476982", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",  752); 
doTest("RFC 6229", "591fc66bcda10e452b03d4551f6b62ac", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718",  768); 
doTest("RFC 6229", "2753cc83988afa3e1688a1d3b42c9a02", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 1008); 
doTest("RFC 6229", "93610d523d1d3f0062b3c2a3bbc7c7f0", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 1024); 
doTest("RFC 6229", "96c248610aadedfeaf8978c03de8205a", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 1520); 
doTest("RFC 6229", "0e317b3d1c73b9e9a4688f296d133a19", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 1536); 
doTest("RFC 6229", "bdf0e6c3cca5b5b9d533b69c56ada120", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 2032); 
doTest("RFC 6229", "88a218b6e2ece1e6246d44c759d19b10", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 2048); 
doTest("RFC 6229", "6866397e95c140534f94263421006e40", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 3056); 
doTest("RFC 6229", "32cb0a1e9542c6b3b8b398abc3b0f1d5", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 3072); 
doTest("RFC 6229", "29a0b8aed54a132324c62e423f54b4c8", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 4080); 
doTest("RFC 6229", "3cb0f3b5020a98b82af9fe154484a168", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718", 4096); 

doTest("RFC 6229", "eaa6bd25880bf93d3f5d1e4ca2611d91", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",    0); 
doTest("RFC 6229", "cfa45c9f7e714b54bdfa80027cb14380", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",   16); 
doTest("RFC 6229", "114ae344ded71b35f2e60febad727fd8", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",  240); 
doTest("RFC 6229", "02e1e7056b0f623900496422943e97b6", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",  256); 
doTest("RFC 6229", "91cb93c787964e10d9527d999c6f936b", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",  496); 
doTest("RFC 6229", "49b18b42f8e8367cbeb5ef104ba1c7cd", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",  512); 
doTest("RFC 6229", "87084b3ba700bade955610672745b374", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",  752); 
doTest("RFC 6229", "e7a7b9e9ec540d5ff43bdb12792d1b35", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20",  768); 
doTest("RFC 6229", "c799b596738f6b018c76c74b1759bd90", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 1008); 
doTest("RFC 6229", "7fec5bfd9f9b89ce6548309092d7e958", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 1024); 
doTest("RFC 6229", "40f250b26d1f096a4afd4c340a588815", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 1520); 
doTest("RFC 6229", "3e34135c79db010200767651cf263073", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 1536); 
doTest("RFC 6229", "f656abccf88dd827027b2ce917d464ec", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 2032); 
doTest("RFC 6229", "18b62503bfbc077fbabb98f20d98ab34", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 2048); 
doTest("RFC 6229", "8aed95ee5b0dcbfbef4eb21d3a3f52f9", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 3056); 
doTest("RFC 6229", "625a1ab00ee39a5327346bddb01a9c18", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 3072); 
doTest("RFC 6229", "a13a7c79c7e119b5ab0296ab28c300b9", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 4080); 
doTest("RFC 6229", "f3e4c0a2e02d1d01f7f0a74618af2b48", "00000000000000000000000000000000", "0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f20", 4096); 
