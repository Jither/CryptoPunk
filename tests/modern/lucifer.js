import test from "ava";
import { LuciferEncryptTransform, LuciferDecryptTransform } from "transforms/modern/lucifer";
import { testBytesToBytes } from "../_testutils";
import { hexToBytes } from "cryptopunk.utils";

function doTest(title, expectedHex, messageHex, keyHex)
{
	const key = hexToBytes(keyHex);
	test("LUCIFER (LSB0) encrypts " + title, testBytesToBytes, LuciferEncryptTransform, expectedHex, messageHex, key);
	test("LUCIFER (LSB0) decrypts " + title, testBytesToBytes, LuciferDecryptTransform, messageHex, expectedHex, key);
}

function doTestSorkin(title, expectedHex, messageHex, keyHex)
{
	const key = hexToBytes(keyHex);
	test("LUCIFER (MSB0) encrypts " + title, testBytesToBytes, LuciferEncryptTransform, expectedHex, messageHex, key, { variant: "msb0" });
	test("LUCIFER (MSB0) decrypts " + title, testBytesToBytes, LuciferDecryptTransform, messageHex, expectedHex, key, { variant: "msb0" });
}

doTest("Richard Outerbridge test vector #1", "a201fc18d62c85ef5965a58295bbf609", "00000000000000000000000000000000", "0123456789abcdeffedcba9876543210");
doTest("Richard Outerbridge test vector #2", "9d14fe4377aa87dd07cc8a14522c21ed", "0123456789abcdeffedcba9876543210", "00000000000000000000000000000000");
doTest("Richard Outerbridge test vector #3", "97f1c104b0f120d194c07024f14815ed", "ffffffffffffffffffffffffffffffff", "0123456789abcdeffedcba9876543210");
doTest("Richard Outerbridge test vector #4", "d442a34dd70e2b4156eb0f2a8aded1a7", "0123456789abcdeffedcba9876543210", "ffffffffffffffffffffffffffffffff");
doTest("Richard Outerbridge test vector #5", "cf46622fa98546bb9a5bc00239eb0c92", "0123456789abcdeffedcba9876543210", "0123456789abcdeffedcba9876543210");
doTest("Richard Outerbridge test vector #6", "7faf65bfc5458fd2dc9cc2266012ef44", "0123456789abcdeffedcba9876543210", "fedcba98765432100123456789abcdef");

doTestSorkin("Test vector generated from lucifer.f #0"  , "cacacacacacacaca4f4f4f4f4f4f4f4f", "00000000000000000000000000000000", "00000000000000000000000000000000");

// Each key bit from 127 to 0
doTestSorkin("Test vector generated from lucifer.f #1"  , "6213cdb97e430de645c6102170cd19f0", "00000000000000000000000000000000", "80000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #2"  , "499340e8f79d166e4752e8c5ebb61c06", "00000000000000000000000000000000", "40000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #3"  , "c60619191daf10b60311cc55d7877d0b", "00000000000000000000000000000000", "20000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #4"  , "fbe7990835e17cb6b11433e5e3a4dd4f", "00000000000000000000000000000000", "10000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #5"  , "81f27343b953b7cfc362e1d0dafcb285", "00000000000000000000000000000000", "08000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #6"  , "f3cb4d0919b560eedccab05593660b27", "00000000000000000000000000000000", "04000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #7"  , "eaf56c7e30de77dd1aa64d0850e97362", "00000000000000000000000000000000", "02000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #8"  , "ac3b533bb1713d73f689da438f69db9a", "00000000000000000000000000000000", "01000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #9"  , "1b6b57cabfc7649c69977ae7db39c9be", "00000000000000000000000000000000", "00800000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #10" , "d45de03f0dcab1b2fd87825e9378cfcb", "00000000000000000000000000000000", "00400000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #11" , "b6d0b2705b874b438b9a58c68c25600b", "00000000000000000000000000000000", "00200000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #12" , "ece50aa1806040db463d7b129941289c", "00000000000000000000000000000000", "00100000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #13" , "0df1623db157a7564c6f124be0eebadd", "00000000000000000000000000000000", "00080000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #14" , "71f06c58cfd801b4219d93eb0a93fed2", "00000000000000000000000000000000", "00040000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #15" , "0902f13bffdeb325a37b2d2995022f15", "00000000000000000000000000000000", "00020000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #16" , "a9f6aa20d56360928ce9ff27a60c9aa3", "00000000000000000000000000000000", "00010000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #17" , "4eb9f0c9eeb6aabc2099b540605a738f", "00000000000000000000000000000000", "00008000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #18" , "6933e46d2716d87b1aa3907f67a58614", "00000000000000000000000000000000", "00004000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #19" , "b5d0326d6fbeb9f0037ab45846e001e0", "00000000000000000000000000000000", "00002000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #20" , "4c4b170b65a2f66d79e1a8ee6c655083", "00000000000000000000000000000000", "00001000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #21" , "252278210e3625fc6d97511650cd9061", "00000000000000000000000000000000", "00000800000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #22" , "4b000a84864d4d91ea0916682dc9b874", "00000000000000000000000000000000", "00000400000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #23" , "9eead9c1366cc14b22e4047684e258de", "00000000000000000000000000000000", "00000200000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #24" , "f8a368efd3a9618c9fd7aaef14718299", "00000000000000000000000000000000", "00000100000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #25" , "2189aed5913da4ad9fc0143dd57e3681", "00000000000000000000000000000000", "00000080000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #26" , "833f673d5efb26c94beb1b44a5808a6b", "00000000000000000000000000000000", "00000040000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #27" , "67b3157b03b564ef617a6d7e66e8c842", "00000000000000000000000000000000", "00000020000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #28" , "762d41bdefaff6e9af112e1441c2ea8c", "00000000000000000000000000000000", "00000010000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #29" , "648925c88533197ee7b938f28057c674", "00000000000000000000000000000000", "00000008000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #30" , "de75cf297c8c035ccc572c370561bed4", "00000000000000000000000000000000", "00000004000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #31" , "bb8eb464f5a7147e5036383b1d0cafe3", "00000000000000000000000000000000", "00000002000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #32" , "cdfc72e22773785bb368f0b3a1f64018", "00000000000000000000000000000000", "00000001000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #33" , "e82b34f3bc20cfd0857f0be526a936b9", "00000000000000000000000000000000", "00000000800000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #34" , "9326d89bdb8c6f344c0a57865949f778", "00000000000000000000000000000000", "00000000400000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #35" , "9a36daf897e8066185c9810f8b6972ef", "00000000000000000000000000000000", "00000000200000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #36" , "751b539da65292f0bb8a14b35b6f6968", "00000000000000000000000000000000", "00000000100000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #37" , "4e3ac5e0f8f49811896eb3137a8acf47", "00000000000000000000000000000000", "00000000080000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #38" , "49420a99495df7b8935cdce5f146825e", "00000000000000000000000000000000", "00000000040000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #39" , "01ad603809fa7e762f7e230803f4eac6", "00000000000000000000000000000000", "00000000020000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #40" , "2fe8687fabaa046c4456c17e629f1d14", "00000000000000000000000000000000", "00000000010000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #41" , "b85d220fefe12f0fcb4c7f4651d5db86", "00000000000000000000000000000000", "00000000008000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #42" , "ff02c6272e03e66cabd6852a80b4d5ba", "00000000000000000000000000000000", "00000000004000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #43" , "b9b7b1d447061d7cad54b1d7305715da", "00000000000000000000000000000000", "00000000002000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #44" , "17222e89c5eb0336661fb73e60a2a690", "00000000000000000000000000000000", "00000000001000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #45" , "e48a5e5c4666a9d7a7aed8122a098aa6", "00000000000000000000000000000000", "00000000000800000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #46" , "31a1520e253e3b8b093fb28a3058c045", "00000000000000000000000000000000", "00000000000400000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #47" , "610cb6dda1303228078365de044fe977", "00000000000000000000000000000000", "00000000000200000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #48" , "e0a5738a926050eb553d779b61a4375e", "00000000000000000000000000000000", "00000000000100000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #49" , "249523d36ecb0387c39cf0e87c1a88c6", "00000000000000000000000000000000", "00000000000080000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #50" , "7dcf8b56c0aa799c24f82af0774a6ec8", "00000000000000000000000000000000", "00000000000040000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #51" , "e5a10c2f38907b9c8b9b3ba53ae33ca2", "00000000000000000000000000000000", "00000000000020000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #52" , "6dd9ff480e1a2c356d71e2e7ee029a74", "00000000000000000000000000000000", "00000000000010000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #53" , "fef7382083a84ab87a63e959cfde8703", "00000000000000000000000000000000", "00000000000008000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #54" , "9b8f25af759c53e0cdd18c077616ec71", "00000000000000000000000000000000", "00000000000004000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #55" , "5162fd25d507d2f7702054ef76245693", "00000000000000000000000000000000", "00000000000002000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #56" , "d5fd8a99e6db4ac8ec98efb737c2dc1e", "00000000000000000000000000000000", "00000000000001000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #57" , "e65087d8cb8ad22e9f609ce87aa1a111", "00000000000000000000000000000000", "00000000000000800000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #58" , "b6c9633e53d8aabf7c5efc2b47bf7d36", "00000000000000000000000000000000", "00000000000000400000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #59" , "5b7b88f041db7398673d35ed6af77e75", "00000000000000000000000000000000", "00000000000000200000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #60" , "b3ff279b0b4f2648de56bf9bea86a37f", "00000000000000000000000000000000", "00000000000000100000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #61" , "5a301d9efdb4e5151dba27baa98cb486", "00000000000000000000000000000000", "00000000000000080000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #62" , "02432be4f6f402b50c673a63fd69841f", "00000000000000000000000000000000", "00000000000000040000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #63" , "a38b92fbca70f6e5b02ee41c85b2a927", "00000000000000000000000000000000", "00000000000000020000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #64" , "bb9a0708b4c9e6e85046d20d84108f7d", "00000000000000000000000000000000", "00000000000000010000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #65" , "541d57966cde1370fbbb49be3c3a03fd", "00000000000000000000000000000000", "00000000000000008000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #66" , "5f1ae41a7fd16c64a7a65c61ee718d1c", "00000000000000000000000000000000", "00000000000000004000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #67" , "18640b81356e88cca008661539b2a6f4", "00000000000000000000000000000000", "00000000000000002000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #68" , "c52a671b8825a1f70bee0b565caebeac", "00000000000000000000000000000000", "00000000000000001000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #69" , "646d4a73c5176f85a1882acc17a6759c", "00000000000000000000000000000000", "00000000000000000800000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #70" , "07bccd31d63396b4698ef10c2d591246", "00000000000000000000000000000000", "00000000000000000400000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #71" , "48fcb4f7504bcc636dfacb16c9fdeae0", "00000000000000000000000000000000", "00000000000000000200000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #72" , "95061dab6a54edbce6f050fba4bffcbb", "00000000000000000000000000000000", "00000000000000000100000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #73" , "2872b0ae8857d1aed5af3816027c6e86", "00000000000000000000000000000000", "00000000000000000080000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #74" , "1e85db7e5e6df7cadc7a4a9e61e66260", "00000000000000000000000000000000", "00000000000000000040000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #75" , "6f862d8f17f06cce5bb14b9227ad0007", "00000000000000000000000000000000", "00000000000000000020000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #76" , "64365cc26a2d7e67cd51bb6c8b68e92b", "00000000000000000000000000000000", "00000000000000000010000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #77" , "a9e641e6f702c90efc7b2bb234248217", "00000000000000000000000000000000", "00000000000000000008000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #78" , "6b06a5b0e95446c909fd17d9cd382085", "00000000000000000000000000000000", "00000000000000000004000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #79" , "0f4215735807dee6d2e33a0bf0224778", "00000000000000000000000000000000", "00000000000000000002000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #80" , "fd673f585f9130f2501a632be1466336", "00000000000000000000000000000000", "00000000000000000001000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #81" , "e763bb8246ef3881b56af65ebb5ab2ac", "00000000000000000000000000000000", "00000000000000000000800000000000"); 
doTestSorkin("Test vector generated from lucifer.f #82" , "b6bd1a6537f8ad16c24c32e772571895", "00000000000000000000000000000000", "00000000000000000000400000000000"); 
doTestSorkin("Test vector generated from lucifer.f #83" , "958c5f1007fddd46348ca6c9b9d3e770", "00000000000000000000000000000000", "00000000000000000000200000000000"); 
doTestSorkin("Test vector generated from lucifer.f #84" , "50899a2755e0354a020324ae658fc24f", "00000000000000000000000000000000", "00000000000000000000100000000000"); 
doTestSorkin("Test vector generated from lucifer.f #85" , "82ddc2ed4f5f50139ca595e0f33dd3ca", "00000000000000000000000000000000", "00000000000000000000080000000000"); 
doTestSorkin("Test vector generated from lucifer.f #86" , "b47b5a0a31a8b2a9ed6fefaadd901347", "00000000000000000000000000000000", "00000000000000000000040000000000"); 
doTestSorkin("Test vector generated from lucifer.f #87" , "b0f65ef0f4411180bd60bc67d65d4d56", "00000000000000000000000000000000", "00000000000000000000020000000000"); 
doTestSorkin("Test vector generated from lucifer.f #88" , "2a8b30bf43fa8c4d3b0207f4e1921741", "00000000000000000000000000000000", "00000000000000000000010000000000"); 
doTestSorkin("Test vector generated from lucifer.f #89" , "29bdfb783a13db416759d56cb7991f3d", "00000000000000000000000000000000", "00000000000000000000008000000000"); 
doTestSorkin("Test vector generated from lucifer.f #90" , "375421e345c3eb136af8d5541e63869f", "00000000000000000000000000000000", "00000000000000000000004000000000"); 
doTestSorkin("Test vector generated from lucifer.f #91" , "b449975bc97d909aba81dd0525045751", "00000000000000000000000000000000", "00000000000000000000002000000000"); 
doTestSorkin("Test vector generated from lucifer.f #92" , "7ab013693b9c4685d43e17d699fb95da", "00000000000000000000000000000000", "00000000000000000000001000000000"); 
doTestSorkin("Test vector generated from lucifer.f #93" , "9a17f18770775d45d5d02f9b14a564d5", "00000000000000000000000000000000", "00000000000000000000000800000000"); 
doTestSorkin("Test vector generated from lucifer.f #94" , "8e5c7ff121766542f1ee18f17976757c", "00000000000000000000000000000000", "00000000000000000000000400000000"); 
doTestSorkin("Test vector generated from lucifer.f #95" , "b069f48f86867086dcb7a9d990475a73", "00000000000000000000000000000000", "00000000000000000000000200000000"); 
doTestSorkin("Test vector generated from lucifer.f #96" , "ea5bc6b88b2ff83afd091c369e06b27e", "00000000000000000000000000000000", "00000000000000000000000100000000"); 
doTestSorkin("Test vector generated from lucifer.f #97" , "30868e731fc79f37409d89755f8c2d3c", "00000000000000000000000000000000", "00000000000000000000000080000000"); 
doTestSorkin("Test vector generated from lucifer.f #98" , "f65b0c177b1f58af1f7342dd6611e351", "00000000000000000000000000000000", "00000000000000000000000040000000"); 
doTestSorkin("Test vector generated from lucifer.f #99" , "1da95ba2c7f6e6b33310ab76dfd35e6c", "00000000000000000000000000000000", "00000000000000000000000020000000"); 
doTestSorkin("Test vector generated from lucifer.f #100", "34bf7d7d4f593311ce9fd3a6370e9e3f", "00000000000000000000000000000000", "00000000000000000000000010000000"); 
doTestSorkin("Test vector generated from lucifer.f #101", "8d1fe61a68033aafab1362341d2305eb", "00000000000000000000000000000000", "00000000000000000000000008000000"); 
doTestSorkin("Test vector generated from lucifer.f #102", "5dc8b25f445c88f39d33ea4019a6bc10", "00000000000000000000000000000000", "00000000000000000000000004000000"); 
doTestSorkin("Test vector generated from lucifer.f #103", "dc0ac7a02f18dc6963e8d86ac02287a7", "00000000000000000000000000000000", "00000000000000000000000002000000"); 
doTestSorkin("Test vector generated from lucifer.f #104", "fd64867ac6115556acb6a7b2db2f4c6c", "00000000000000000000000000000000", "00000000000000000000000001000000"); 
doTestSorkin("Test vector generated from lucifer.f #105", "5986f90e916aab3946ab61d9194b0c6c", "00000000000000000000000000000000", "00000000000000000000000000800000"); 
doTestSorkin("Test vector generated from lucifer.f #106", "c4e286c1dab0d3c4f5519bf8096aeb74", "00000000000000000000000000000000", "00000000000000000000000000400000"); 
doTestSorkin("Test vector generated from lucifer.f #107", "345c0631d829967f7c45ccbd50c912ea", "00000000000000000000000000000000", "00000000000000000000000000200000"); 
doTestSorkin("Test vector generated from lucifer.f #108", "4ff30f63821aedbea8e0caed48325a2b", "00000000000000000000000000000000", "00000000000000000000000000100000"); 
doTestSorkin("Test vector generated from lucifer.f #109", "33d23890ea679234a5b80be7c41a0f45", "00000000000000000000000000000000", "00000000000000000000000000080000"); 
doTestSorkin("Test vector generated from lucifer.f #110", "438079c298ffd25bf20f2ccfe11601d5", "00000000000000000000000000000000", "00000000000000000000000000040000"); 
doTestSorkin("Test vector generated from lucifer.f #111", "0a29654f88bb7f4ac8c1ab98307c6238", "00000000000000000000000000000000", "00000000000000000000000000020000"); 
doTestSorkin("Test vector generated from lucifer.f #112", "4af9a5a05486b63227a75d477d3df9ac", "00000000000000000000000000000000", "00000000000000000000000000010000"); 
doTestSorkin("Test vector generated from lucifer.f #113", "fedc701a9f71773f19fc8fc5d1520c5c", "00000000000000000000000000000000", "00000000000000000000000000008000"); 
doTestSorkin("Test vector generated from lucifer.f #114", "a579563a4310d384ed283639c7d3dd53", "00000000000000000000000000000000", "00000000000000000000000000004000"); 
doTestSorkin("Test vector generated from lucifer.f #115", "60427e121a80ef13293aeeb074b2b6ba", "00000000000000000000000000000000", "00000000000000000000000000002000"); 
doTestSorkin("Test vector generated from lucifer.f #116", "6f6a6d2c9f071a2fe1fa164c3346d372", "00000000000000000000000000000000", "00000000000000000000000000001000"); 
doTestSorkin("Test vector generated from lucifer.f #117", "0a4010a695c149a7fdf0aac2acf501ce", "00000000000000000000000000000000", "00000000000000000000000000000800"); 
doTestSorkin("Test vector generated from lucifer.f #118", "4671b7920473ffa5ad9b51b3f3de29ea", "00000000000000000000000000000000", "00000000000000000000000000000400"); 
doTestSorkin("Test vector generated from lucifer.f #119", "dfb9d3866d3f6a16747fef09139b4505", "00000000000000000000000000000000", "00000000000000000000000000000200"); 
doTestSorkin("Test vector generated from lucifer.f #120", "923516256efc8d1f93cdf7306012f217", "00000000000000000000000000000000", "00000000000000000000000000000100"); 
doTestSorkin("Test vector generated from lucifer.f #121", "bbf096276494d42e647fa34de4b8a04b", "00000000000000000000000000000000", "00000000000000000000000000000080"); 
doTestSorkin("Test vector generated from lucifer.f #122", "8109c7632f9158eef352c7970c3793d9", "00000000000000000000000000000000", "00000000000000000000000000000040"); 
doTestSorkin("Test vector generated from lucifer.f #123", "54f3793bd1e83d03100b9dfc23b97134", "00000000000000000000000000000000", "00000000000000000000000000000020"); 
doTestSorkin("Test vector generated from lucifer.f #124", "4ebdefe1e1f3aa6458000957de651aef", "00000000000000000000000000000000", "00000000000000000000000000000010"); 
doTestSorkin("Test vector generated from lucifer.f #125", "d5c53534e6df4bf3bba9a6924a1e8f59", "00000000000000000000000000000000", "00000000000000000000000000000008"); 
doTestSorkin("Test vector generated from lucifer.f #126", "73209308618085e48e8826cd6c0ca81e", "00000000000000000000000000000000", "00000000000000000000000000000004"); 
doTestSorkin("Test vector generated from lucifer.f #127", "dc0176e25f15c71fd97b85059ac911c6", "00000000000000000000000000000000", "00000000000000000000000000000002"); 
doTestSorkin("Test vector generated from lucifer.f #128", "5b867f050b4888575ba283f36522a777", "00000000000000000000000000000000", "00000000000000000000000000000001");

// Each plaintext bit from 127 to 0
doTestSorkin("Test vector generated from lucifer.f #1"  , "d77737e24f77bc9495da1354990686f3", "80000000000000000000000000000000", "00000000000000000000000000000000");
doTestSorkin("Test vector generated from lucifer.f #2"  , "36e1f347c4d307642ac0cfd33a91fe0e", "40000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #3"  , "51db13da80de65b024edeeb6a8b0e08b", "20000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #4"  , "6260c57b7cc410c9bf363064aac53361", "10000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #5"  , "32d0776d3ddffb2a11cafe86d678cdd1", "08000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #6"  , "9ff56308650fccb952338b97f6b9eddb", "04000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #7"  , "9b9ce2d606c768cd6269cd255616e8e0", "02000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #8"  , "22ee60612e88b7ae027fdae0fb682a37", "01000000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #9"  , "94d77737e24f77bcf395da1354990686", "00800000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #10" , "6436e1f347c4d3070e2ac0cfd33a91fe", "00400000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #11" , "b051db13da80de658b24edeeb6a8b0e0", "00200000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #12" , "c96260c57b7cc41061bf363064aac533", "00100000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #13" , "2a32d0776d3ddffbd111cafe86d678cd", "00080000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #14" , "b99ff56308650fccdb52338b97f6b9ed", "00040000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #15" , "cd9b9ce2d606c768e06269cd255616e8", "00020000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #16" , "ae22ee60612e88b737027fdae0fb682a", "00010000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #17" , "bc94d77737e24f7786f395da13549906", "00008000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #18" , "076436e1f347c4d3fe0e2ac0cfd33a91", "00004000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #19" , "65b051db13da80dee08b24edeeb6a8b0", "00002000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #20" , "10c96260c57b7cc43361bf363064aac5", "00001000000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #21" , "fb2a32d0776d3ddfcdd111cafe86d678", "00000800000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #22" , "ccb99ff56308650feddb52338b97f6b9", "00000400000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #23" , "68cd9b9ce2d606c7e8e06269cd255616", "00000200000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #24" , "b7ae22ee60612e882a37027fdae0fb68", "00000100000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #25" , "77bc94d77737e24f0686f395da135499", "00000080000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #26" , "d3076436e1f347c491fe0e2ac0cfd33a", "00000040000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #27" , "de65b051db13da80b0e08b24edeeb6a8", "00000020000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #28" , "c410c96260c57b7cc53361bf363064aa", "00000010000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #29" , "dffb2a32d0776d3d78cdd111cafe86d6", "00000008000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #30" , "0fccb99ff5630865b9eddb52338b97f6", "00000004000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #31" , "c768cd9b9ce2d60616e8e06269cd2556", "00000002000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #32" , "88b7ae22ee60612e682a37027fdae0fb", "00000001000000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #33" , "4f77bc94d77737e2990686f395da1354", "00000000800000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #34" , "c4d3076436e1f3473a91fe0e2ac0cfd3", "00000000400000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #35" , "80de65b051db13daa8b0e08b24edeeb6", "00000000200000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #36" , "7cc410c96260c57baac53361bf363064", "00000000100000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #37" , "3ddffb2a32d0776dd678cdd111cafe86", "00000000080000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #38" , "650fccb99ff56308f6b9eddb52338b97", "00000000040000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #39" , "06c768cd9b9ce2d65616e8e06269cd25", "00000000020000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #40" , "2e88b7ae22ee6061fb682a37027fdae0", "00000000010000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #41" , "e24f77bc94d7773754990686f395da13", "00000000008000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #42" , "47c4d3076436e1f3d33a91fe0e2ac0cf", "00000000004000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #43" , "da80de65b051db13b6a8b0e08b24edee", "00000000002000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #44" , "7b7cc410c96260c564aac53361bf3630", "00000000001000000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #45" , "6d3ddffb2a32d07786d678cdd111cafe", "00000000000800000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #46" , "08650fccb99ff56397f6b9eddb52338b", "00000000000400000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #47" , "d606c768cd9b9ce2255616e8e06269cd", "00000000000200000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #48" , "612e88b7ae22ee60e0fb682a37027fda", "00000000000100000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #49" , "37e24f77bc94d7771354990686f395da", "00000000000080000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #50" , "f347c4d3076436e1cfd33a91fe0e2ac0", "00000000000040000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #51" , "13da80de65b051dbeeb6a8b0e08b24ed", "00000000000020000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #52" , "c57b7cc410c962603064aac53361bf36", "00000000000010000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #53" , "776d3ddffb2a32d0fe86d678cdd111ca", "00000000000008000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #54" , "6308650fccb99ff58b97f6b9eddb5233", "00000000000004000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #55" , "e2d606c768cd9b9ccd255616e8e06269", "00000000000002000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #56" , "60612e88b7ae22eedae0fb682a37027f", "00000000000001000000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #57" , "7737e24f77bc94d7da1354990686f395", "00000000000000800000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #58" , "e1f347c4d3076436c0cfd33a91fe0e2a", "00000000000000400000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #59" , "db13da80de65b051edeeb6a8b0e08b24", "00000000000000200000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #60" , "60c57b7cc410c962363064aac53361bf", "00000000000000100000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #61" , "d0776d3ddffb2a32cafe86d678cdd111", "00000000000000080000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #62" , "f56308650fccb99f338b97f6b9eddb52", "00000000000000040000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #63" , "9ce2d606c768cd9b69cd255616e8e062", "00000000000000020000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #64" , "ee60612e88b7ae227fdae0fb682a3702", "00000000000000010000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #65" , "468e224fce6fd4771fe16105df417498", "00000000000000008000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #66" , "8c5901d7b165ade98d66c8c1030eaa94", "00000000000000004000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #67" , "5498b27ce0d908b4aeff60a96e308a59", "00000000000000002000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #68" , "464479a2ad16ae73472cd659e7efe2cb", "00000000000000001000000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #69" , "415bbb910a95223e3b82286715cd05b4", "00000000000000000800000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #70" , "f49d03b3c5725828429edfd383a03a0c", "00000000000000000400000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #71" , "caa4b0a4fff58a66d3457eec029e306b", "00000000000000000200000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #72" , "ba7e62b909496480538d34ad0374c797", "00000000000000000100000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #73" , "77468e224fce6fd4981fe16105df4174", "00000000000000000080000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #74" , "e98c5901d7b165ad948d66c8c1030eaa", "00000000000000000040000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #75" , "b45498b27ce0d90859aeff60a96e308a", "00000000000000000020000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #76" , "73464479a2ad16aecb472cd659e7efe2", "00000000000000000010000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #77" , "3e415bbb910a9522b43b82286715cd05", "00000000000000000008000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #78" , "28f49d03b3c572580c429edfd383a03a", "00000000000000000004000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #79" , "66caa4b0a4fff58a6bd3457eec029e30", "00000000000000000002000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #80" , "80ba7e62b909496497538d34ad0374c7", "00000000000000000001000000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #81" , "d477468e224fce6f74981fe16105df41", "00000000000000000000800000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #82" , "ade98c5901d7b165aa948d66c8c1030e", "00000000000000000000400000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #83" , "08b45498b27ce0d98a59aeff60a96e30", "00000000000000000000200000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #84" , "ae73464479a2ad16e2cb472cd659e7ef", "00000000000000000000100000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #85" , "223e415bbb910a9505b43b82286715cd", "00000000000000000000080000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #86" , "5828f49d03b3c5723a0c429edfd383a0", "00000000000000000000040000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #87" , "8a66caa4b0a4fff5306bd3457eec029e", "00000000000000000000020000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #88" , "6480ba7e62b90949c797538d34ad0374", "00000000000000000000010000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #89" , "6fd477468e224fce4174981fe16105df", "00000000000000000000008000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #90" , "65ade98c5901d7b10eaa948d66c8c103", "00000000000000000000004000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #91" , "d908b45498b27ce0308a59aeff60a96e", "00000000000000000000002000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #92" , "16ae73464479a2adefe2cb472cd659e7", "00000000000000000000001000000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #93" , "95223e415bbb910acd05b43b82286715", "00000000000000000000000800000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #94" , "725828f49d03b3c5a03a0c429edfd383", "00000000000000000000000400000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #95" , "f58a66caa4b0a4ff9e306bd3457eec02", "00000000000000000000000200000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #96" , "496480ba7e62b90974c797538d34ad03", "00000000000000000000000100000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #97" , "ce6fd477468e224fdf4174981fe16105", "00000000000000000000000080000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #98" , "b165ade98c5901d7030eaa948d66c8c1", "00000000000000000000000040000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #99" , "e0d908b45498b27c6e308a59aeff60a9", "00000000000000000000000020000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #100", "ad16ae73464479a2e7efe2cb472cd659", "00000000000000000000000010000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #101", "0a95223e415bbb9115cd05b43b822867", "00000000000000000000000008000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #102", "c5725828f49d03b383a03a0c429edfd3", "00000000000000000000000004000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #103", "fff58a66caa4b0a4029e306bd3457eec", "00000000000000000000000002000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #104", "09496480ba7e62b90374c797538d34ad", "00000000000000000000000001000000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #105", "4fce6fd477468e2205df4174981fe161", "00000000000000000000000000800000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #106", "d7b165ade98c5901c1030eaa948d66c8", "00000000000000000000000000400000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #107", "7ce0d908b45498b2a96e308a59aeff60", "00000000000000000000000000200000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #108", "a2ad16ae7346447959e7efe2cb472cd6", "00000000000000000000000000100000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #109", "910a95223e415bbb6715cd05b43b8228", "00000000000000000000000000080000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #110", "b3c5725828f49d03d383a03a0c429edf", "00000000000000000000000000040000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #111", "a4fff58a66caa4b0ec029e306bd3457e", "00000000000000000000000000020000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #112", "b909496480ba7e62ad0374c797538d34", "00000000000000000000000000010000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #113", "224fce6fd477468e6105df4174981fe1", "00000000000000000000000000008000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #114", "01d7b165ade98c59c8c1030eaa948d66", "00000000000000000000000000004000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #115", "b27ce0d908b4549860a96e308a59aeff", "00000000000000000000000000002000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #116", "79a2ad16ae734644d659e7efe2cb472c", "00000000000000000000000000001000", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #117", "bb910a95223e415b286715cd05b43b82", "00000000000000000000000000000800", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #118", "03b3c5725828f49ddfd383a03a0c429e", "00000000000000000000000000000400", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #119", "b0a4fff58a66caa47eec029e306bd345", "00000000000000000000000000000200", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #120", "62b909496480ba7e34ad0374c797538d", "00000000000000000000000000000100", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #121", "8e224fce6fd47746e16105df4174981f", "00000000000000000000000000000080", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #122", "5901d7b165ade98c66c8c1030eaa948d", "00000000000000000000000000000040", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #123", "98b27ce0d908b454ff60a96e308a59ae", "00000000000000000000000000000020", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #124", "4479a2ad16ae73462cd659e7efe2cb47", "00000000000000000000000000000010", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #125", "5bbb910a95223e4182286715cd05b43b", "00000000000000000000000000000008", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #126", "9d03b3c5725828f49edfd383a03a0c42", "00000000000000000000000000000004", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #127", "a4b0a4fff58a66ca457eec029e306bd3", "00000000000000000000000000000002", "00000000000000000000000000000000"); 
doTestSorkin("Test vector generated from lucifer.f #128", "7e62b909496480ba8d34ad0374c79753", "00000000000000000000000000000001", "00000000000000000000000000000000"); 

test("LUCIFER (MSB0) does exercise (1000 iterations)", t => {
	let key = hexToBytes("0123456789abcdeffedcba9876543210");
	let plain = hexToBytes("00000000000000000000000000000000");
	const tf = new LuciferEncryptTransform();
	const options = { variant: "msb0" };
	let result;
	for (let i = 0; i < 1000; i++)
	{
		result = tf.transform(plain, key, options);
		// Next iteration: Encrypt key (as plaintext) with previous result (as key)
		plain = key;
		key = result;
	}

	t.deepEqual(hexToBytes("6b952f8fdfa35b335f849757fec58c07"), result);
});